{
  "name": "replanning_scope_control",
  "description": "Test intelligent replanning scope controls with different constraint levels",
  "tasks": [
    {
      "id": "urgent_presentation",
      "title": "Presentation Due Soon",
      "kind": "assignment",
      "estimated_minutes": 90,
      "min_block_minutes": 45,
      "max_block_minutes": 90,
      "deadline": "2025-09-26T14:00:00",
      "weight": 3.0,
      "created_at": "2025-09-25T08:00:00"
    },
    {
      "id": "flexible_study",
      "title": "Flexible Study Session",
      "kind": "study",
      "estimated_minutes": 120,
      "min_block_minutes": 30,
      "max_block_minutes": 60,
      "deadline": "2025-09-28T23:59:00",
      "weight": 1.5,
      "created_at": "2025-09-25T09:00:00",
      "metadata": {
        "flexible": true
      }
    },
    {
      "id": "imminent_meeting_prep",
      "title": "Meeting Preparation",
      "kind": "work",
      "estimated_minutes": 60,
      "min_block_minutes": 60,
      "max_block_minutes": 60,
      "deadline": "2025-09-26T10:30:00",
      "weight": 2.5,
      "created_at": "2025-09-25T15:00:00"
    },
    {
      "id": "new_task",
      "title": "New Task to Schedule",
      "kind": "assignment",
      "estimated_minutes": 75,
      "min_block_minutes": 30,
      "max_block_minutes": 75,
      "deadline": "2025-09-27T18:00:00",
      "weight": 2.0,
      "created_at": "2025-09-26T08:00:00"
    }
  ],
  "existing_schedule": [
    {
      "task_id": "urgent_presentation",
      "start": "2025-09-26T11:00:00",
      "duration_minutes": 90,
      "locked": false
    },
    {
      "task_id": "flexible_study",
      "start": "2025-09-26T13:30:00",
      "duration_minutes": 60,
      "locked": false
    },
    {
      "task_id": "flexible_study",
      "start": "2025-09-26T15:00:00",
      "duration_minutes": 60,
      "locked": false
    },
    {
      "task_id": "imminent_meeting_prep",
      "start": "2025-09-26T09:30:00",
      "duration_minutes": 60,
      "locked": true
    }
  ],
  "availability": [
    {
      "start": "2025-09-26T09:00:00",
      "end": "2025-09-26T17:00:00"
    },
    {
      "start": "2025-09-27T09:00:00",
      "end": "2025-09-27T17:00:00"
    }
  ],
  "busy_events": [
    {
      "id": "lunch_break",
      "title": "Lunch Break",
      "start": "2025-09-26T12:00:00",
      "end": "2025-09-26T13:00:00",
      "hard": true
    },
    {
      "id": "team_standup",
      "title": "Daily Standup",
      "start": "2025-09-27T09:00:00",
      "end": "2025-09-27T09:30:00",
      "hard": true
    }
  ],
  "preferences": {
    "timezone": "UTC",
    "workday_start": "09:00",
    "workday_end": "17:00",
    "max_daily_effort_minutes": 480,
    "session_granularity_minutes": 30,
    "replan_buffer_hours": 2
  },
  "test_scenarios": {
    "minimal_scope": {
      "replan_scope": "minimal",
      "expected": {
        "max_blocks_to_move": 2,
        "min_stability_ratio": 0.6,
        "max_disruption_score": 50.0,
        "protected_blocks_count": ">= 1",
        "move_candidates_count": "<= 2"
      }
    },
    "conservative_scope": {
      "replan_scope": "conservative",
      "expected": {
        "max_blocks_to_move": 5,
        "min_stability_ratio": 0.4,
        "max_disruption_score": 60.0,
        "move_candidates_count": "<= 3"
      }
    },
    "moderate_scope": {
      "replan_scope": "moderate",
      "expected": {
        "max_blocks_to_move": 10,
        "min_stability_ratio": 0.3,
        "max_disruption_score": 80.0,
        "move_candidates_count": ">= 2"
      }
    },
    "aggressive_scope": {
      "replan_scope": "aggressive",
      "expected": {
        "max_blocks_to_move": 20,
        "min_stability_ratio": 0.2,
        "max_disruption_score": 90.0,
        "move_candidates_count": ">= 3"
      }
    },
    "complete_scope": {
      "replan_scope": "complete",
      "expected": {
        "max_blocks_to_move": null,
        "min_stability_ratio": 0.0,
        "max_disruption_score": 100.0,
        "move_candidates_count": ">= 3"
      }
    },
    "protected_constraints": {
      "replan_scope": "moderate",
      "constraints": {
        "protected_task_ids": ["imminent_meeting_prep", "urgent_presentation"]
      },
      "expected": {
        "protected_blocks": ["imminent_meeting_prep", "urgent_presentation"],
        "move_candidates_exclude": ["imminent_meeting_prep", "urgent_presentation"],
        "none_changes": ["imminent_meeting_prep", "urgent_presentation"]
      }
    },
    "frozen_periods": {
      "replan_scope": "moderate",
      "constraints": {
        "frozen_periods": [
          {
            "start": "2025-09-26T09:00:00",
            "end": "2025-09-26T11:00:00"
          }
        ]
      },
      "expected": {
        "protected_blocks_contain": ["imminent_meeting_prep"],
        "blocks_in_frozen_period_protected": true
      }
    },
    "max_move_limit": {
      "replan_scope": "aggressive",
      "constraints": {
        "max_blocks_to_move": 1
      },
      "expected": {
        "move_candidates_count": "<= 1",
        "stability_ratio": ">= 0.7"
      }
    }
  },
  "metadata": {
    "category": "replanning",
    "complexity": "high",
    "test_type": "scope_control_validation",
    "features_tested": [
      "replanning_scope_levels",
      "protected_task_constraints",
      "frozen_time_periods",
      "move_candidate_limits",
      "disruption_analysis",
      "stability_preservation"
    ]
  }
}